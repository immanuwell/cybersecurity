# Trojans, protected messengers and mafia

Good day!

I would like to tell you about the amazing stories of the capture of major criminal authorities, and what role Trojans and messengers play in all this.

One day, Italian policemen were looking at the streets in a small Spanish town through Google Street View on their police (or not so) cases and saw a man there whom they recognized ... an Italian mafioso who escaped 20 years ago, sentenced to life for murder and drug trafficking! Having received such a divine tip, the police checked the photos from Facebook with geotags near this place, and found out that our mafia-recidivist killer-drug dealer had long ago turned himself into the chef of a small restaurant La Cocina de Manu and the owner of the grocery store El Huertode Manu.

In general, we turn to that inspired by the old story, in the exquisite pattern of which we will see bizarre interweaving of Italian policemen, Estonian programmers, Sicilian mafiosi, Australian activists, Bavarian IT specialists and British journalists.

![GoogleStreetView with a mafia-recidivist-killer-drug-vegetable dealer, sent to the Italian police by the Blessed Virgin herself Марией](https://habrastorage.org/r/w1560/getpro/habr/upload_files/cb1/bb6/715/cb1bb671525fabfc545f642e45806ad8.png)

> GoogleStreetView with a mafia-recidivist-killer-drug-vegetable dealer, sent to the Italian police by the Blessed Virgin Mary herself



### Skype

It all started in 2003, when several Estonian programmers, led by a Dane and a Swede, filed a peer-to-peer call service, which then developed into a popular video calling application, which in turn developed into a file sharing service, which soon developed into a slowing and flying monster on your computer, installed there only to call your elderly parents once a week. That is, Skype appeared. And no matter what twists and turns this service experienced, it stood on two pillars: peer-to-peer communication, that is, data between users' computers is transmitted directly, without using Skype servers itself; and encryption using AES-256 and RC-4 algorithms (at the time of the events described), thanks to which, even intercepting all the data on the way between users, it should have been impossible to read/listen to/view them.

And I must say that the appearance of Skype with a distributed system for transmitting well-encrypted data created a lot of problems for law enforcement officers of all countries: starting from the fact that the existing legislation was written for wiretapping telephone networks and simply did not include such a concept as "Information and telecommunications network Internet"; ending with the fact that the head office of the company itself is likely not only was he outside your national jurisdiction, but also in a country that you can't find on the globe without a magnifying glass.

But problems for some are a joy for others, so Skype began to gain truly universal popularity among criminal elements: from street pushers and pimps to mafia godfathers.

There are two solutions to any problem:

1. Fast and efficient — God grant you will quit by the time of the deferred "reckoning" for this speed and efficiency;
2. Long and thorough — God forbid they will not be fired by the time of implementation for the inevitable excess of the budget and deadlines.

The same dilemma faced countries around the world: for example, Saudi Arabia and China chose the first style of solution, hitting Skype with a bang, banning or extremely complicating its use on their territory. Most countries still chose the second style - they began to whine.

Moreover, the power of whining grew gradually, along with the growing popularity of Skype, and, perhaps, reached its apogee in 2009:

1. The first, from the sources available to me, the drug police from Zurich began to whine back in 2007. Complaining that Skype refuses to cooperate with them to track and decrypt drug traffickers' conversations.
2. In January 2009, he tells about the use of Skype by drug traffickers in Milan, where in an interview an Italian policeman complains about the impossibility of his wiretapping, which is especially offensive to Italians, since they are the ones from all EU countries who most actively use wiretapping.
3. In February of the same year, the work of the Legal Commission of the European Union begins with the aim of creating common legislation on wiretapping Internet telephony, because "The company currently refuses to share its encryption system with the authorities of the Eurozone countries." Again, the Italians are most outraged.

And in June 2010 they take Giuseppe Falzone, the leader of Cosa Nostra, who had been hiding from the authorities for 11 years. Even plastic surgery didn't help, because they figured him out via Skype, and at the same time they replenished the evidence base by recording his conversations and messages. And if there are fans of conspiracy theories among us, then we take out notebooks and sharpen pencils — exactly a month later, the encryption algorithm of the current version of Skype leaks into the network. A coincidence? I don't think so! 

But for the most interesting thing, we have to say thank you to one Australian activist, a lover of coming to visit and then not leaving for seven years. Because it was Wikileaks that published the data from which it became known that the German police had a working solution for obtaining Skype data back in early 2008, developed by a private Bavarian IT firm. Yes, it was very expensive and most of the "leaked" correspondence was disputes about who should pay these 3,500 euros per month for one listening station. But you still remember about the fate of long and thorough solutions to problems?  

Yes, you got it right: while the big shots from the European Union and the Italian police were publicly whining and whining, talking about the "invulnerable protection of Skype" and the danger it poses to the World community, their colleagues had been able to calmly listen to everyone for at least a year, especially those who were confident in the "invulnerable protection of Skype". It seems that there are people in the leadership of Interpol and the Italian police who prefer, and most importantly, are able to embody those, albeit expensive and long, but thorough solutions to problems. And the general whining and the BBC interview with the Italian police is an equally thoroughly conducted disinformation campaign. 

Returning to the news about the fugitive Italian chef-mafia-recidivist-murderer-drug-vegetable dealer, I would like to say the following:

If you see an article in the news about how the police of any country managed to detain a dangerous criminal due to extraordinary luck or a combination of circumstances, then most likely, behind this "luck" is the hard work of a large number of dedicated people, a well-built network of informants and the latest technologies in the field of IT, artificial intelligence and facial recognition. And the official version of the "miracle" is just an attempt to hide the real sources of information and the real capabilities of police technology.

That's how the first round of confrontation with the Skype service for the "openness" of correspondence and conversations of users took place, in which representatives of the law won, not without problems. However, these difficulties were caused by the rebellious youth of the Internet, which is inevitably followed by conformist maturity. It was Skype that became one of those first popular Internet services who changed their berets and leather jacket for polished shoes and a suit. Moreover, strictly colors and styles prescribed by the corporate dress code. In 2012, the company was bought by the tech giant Microsoft, which immediately declared its desire to cooperate with the authorities. Moreover, the entire structure of Skype data transmission and storage was changed: intermediate servers appeared between users, due to which, according to the official version, the reliability of the service increased, and according to the unofficial version, the "wiretapping" of users was facilitated. However, from a purely technical point of view, the versions do not contradict each other and both can be true.

The emergence of social networks has caused an unexpected stab in the back of criminal organizations: the availability of data (users post their photos and quotes themselves!), multiplied by the natural desire to show off their luxurious life and the discrepancy of this life with tax returns, created an excellent source of primary tips on possible mafia members and drug cartels.

According to the statements of the Italian police, it was the promotion of one suspicious Facebook profile in 2014 that helped to obtain the data from which Operation Apocalypse was born — the arrest of 95 Cosa Nostra members in Palermo.

I 'll make a reservation right there: we have already found out that such explanations should be treated with a degree of skepticism, and this was only one of the real sources.

From comparing several articles about this operation and the explanations of my Italian colleagues, a slightly more complex picture turns out. First there was a statement about racketeering from the head of a fuel company in Palermo, who pointed to one of the mafia members who collected "tribute" from him. Checking this "fighter" showed that he "shone" several times on the Facebook profile photos of a suspiciously rich man with an assumed name and surname. Operational surveillance and wiretapping of a lobster dinner lover on his yacht in the company of the right Sicilian boys showed that, despite his 28 years, he is already acting as the leader of Cosa Nostra in Palermo. However, under the strict guidance of his 37-year—old cousin Gregorio Palazzotto, who in 2013 mastered the remote work skill that is so relevant now - from prison.

Here it is interesting to note one psychological aspect that manifested itself in this story. The management of the fuel company for many years meekly paid "tribute" to the mafia, until the difficulties with cashing out and money laundering forced Cosa Nostra to change its approach. Mafiosi began to simply send their personal bills for payment. And it's one thing just to give your money, and it's quite another to see firsthand what this money is spent on. And despite the reputation of assistants and intercessors of the poor, it turned out that Cosa Nostra spends the lion's share of money on expensive suits, shoes and other items, as they say, demonstrative consumption. Here is the head of the fuel company and "bombed". 

As we can see, by 2014, public Internet services began to "fight in the other direction", turning for organized crime from a way of secure communication into a full-flowing source of information leakage. But, thank God, we live in a world of victorious market economy and free enterprise, so if there is a demand for secure communications for criminal communities, then there will be a supply. Moreover, there were so many offers that I decided to tell only about the largest and most interesting providers of encrypted communications.



### ENNETCOM

The Dutch company **ENNETCOM** became a pioneer, which recognized the needs of the market back in 2011 and began selling modified Blackberries around the world: their speaker and microphone were turned off, Internet connection was only possible to transfer data to the servers of ENNETCOM itself, and they underwent additional PGP encryption. The most interesting thing is that the company worked quite legally, had offices in Amsterdam and Dubai, kept servers in Canada, renting through the service Blackberryenterprise. Business was going well, because in addition to the subscription fee of 100-150 euros per month, the modified phones themselves were sold three times more expensive than the "stock" BlackBerry phone.But on April 19, 2016, the Canadian police, at the request of the Dutch police, arrested the servers, and 19 thousand ENNETCOM customers received "Happiness E-mails".

![](https://habrastorage.org/r/w1560/getpro/habr/upload_files/c69/a66/9e3/c69a669e339244f8cafabb531b3d813d.png) 

> "URGENT MESSAGE from the Netherlands police. The ENNETCOM BlackBerry servers that you use for encrypted communication have been confiscated and will be examined during a large-scale criminal investigation conducted by the Dutch Prosecutor's Office. This means that for some time you will not be able to use the services of this communication provider ...".

The most interesting thing is that ENNETCOM stored not only the messages themselves on its servers, but also both types of encryption keys! True, without binding to each other, so it took about a year for the Dutch police to decrypt all 3.6 million messages.

 The most notable results of this painstaking work were:

- The arrest of the organizer of two contract killings during the war between criminal gangs in Amsterdam in 2014. In order to develop general erudition: in 2014 prices, the murder of the boss of a European criminal gang costs 130 thousand euros
- The arrest of the largest batch of illegal weapons in Britain in 2014: 22 Czech Kalash, 9 Czech Scorpions and more than 1,000 rounds of ammunition.

In general, the number of providers who in 2014-2017 worked renting BlackBerry Enterprise servers (that is, the traffic of your phones goes only through these dedicated servers that BlackBerry itself does not have access to), plus additional encryption via the PGP protocol, is impressive: Phantom, GlobalData, Elite, SecureMobile, Public PGP, PGP Class, PGP Safe, FortisIceland PGP — thousands of them! As you understand, such an intense competition for such a rich market could not proceed according to the rules. Therefore, companies did not skimp on all sorts of tricks: from specially laid incompatibility with competitors' products to bribing Internet reviewers. By the way, you may ask, why PGP encryption? But because GNU is a license - even criminals and drug dealers are behind OpenSource!



### EncroChat

Nevertheless, rumors about BlackBerry Inc.'s cooperation with the authorities and the news that 3.6 million ENNETCOM messages managed to be decrypted did not go unnoticed, and since 2017, the popularity of PGP services has been falling sharply, and one of the giants of criminal mobile communications, I'm not afraid to say this, comes on the scene - **EncroChat**.

EncroChat built its system in a completely different way: it developed a special protected version of Android, with a built-in chat with OTR encryption and a "panic code" function, when entering a certain PIN code on the lock screen, all data from the device was deleted. In the phones themselves, the microphone, camera and GPS module were physically disconnected. All data went through servers owned by EncroChat and located in France, the SIM cards were from the Dutch KPN. In just a year, EncroChat phones have become a generally accepted standard in the "industry" of arms and drug trafficking, and by mid-2020, the service had 60 thousand active users.

But everything comes to an end, it came on June 12, 2020, and for EncroChat. The company dissolved itself, informing customers in a recent message that its servers had been hacked and they could no longer guarantee the security of the service. And they were absolutely right. Since 2019, the police of France, the Netherlands and the UK, with the financial support of Europol, have been actively working on hacking the EncroChat system. And by March 2020, it was at least partially successful. The police, through the servers of EncroChat itself, were able to infect the phones of about half of the service's customers with a Trojan. The Trojan duplicated all messages directly to the police, and could also change PIN codes to unlock the phone and disable the "panic code". Thus, the police received more than 20 million messages. 

The most notable results of this operation were:

- The closure of nine laboratories for the production of methamphetamine, the confiscation of three tons of finished drugs and 20 million euros in cash in the Netherlands. About 100 suspects have been arrested.
- In the UK, 746 suspects were arrested for drug and weapons trafficking, committing and planning contract killings. 2.7 tons of heavy drugs were seized and 55 million pounds of cash was confiscated. By the way, an analysis of all messages received from Encrochat users in the UK (about 10 thousand people) showed that none of the British customers used this service for any legal activity.



### SkyGlobal

But we must admit that EncroChat was not a monopolist in the "gangster communications" market, so the self—liquidation of this service led to a sharp increase in the popularity of its main competitor, the Canadian **SkyGlobal**. A secure communications provider with a very interesting localization of the customer base: a quarter of the 71 thousand subscribers of the company lived in the Rotterdam and Antwerp area, and another quarter — in Colombia.

SkyGlobal's main service was subscription access to the SkyECC messenger, which was available for Android, iOS and Blackberry OS. The phones themselves could be bought from the provider, then cameras, microphones, GPS module were turned off in them; the possibility of remote formatting of the phone's memory was built in. The main feature of the messenger was encryption using a specially developed ECC (elliptic cryptography) algorithm. Skyglobal was so confident in the reliability of the algorithms and the quality of the messenger code that it even announced a competition to hack its service, and with a rather large prize fund of 4 million. dollars.

 Apparently, Europol became the "winner" of the hackathon again. First, on February 9, 2021, 1.5 tons of heroin are "taken" in the port of Rotterdam. Then, on February 12, 16.1 tons of cocaine are seized in Hamburg, and on February 24 — 7.2 tons in Antwerp. Moreover, according to the invoices, the final delivery address of the "Belgian" cocaine coincided with the departure address of the "German" — a warehouse in the village of Bleskengraaf in the province of South Holland. In total, 23.3 tons of cocaine with a retail value of 600 million euros (yes, six hundred million euros, I didn't make a typo).

 But that's not all: Tuesday, March 9, 2021, comes, and in Belgium 1,600 police officers conduct 200 raids across the country. As a result, 48 people were arrested, including lawyers, members of the Hell's Angels biker gang, active police officers, a civilian employee of the Belgian prosecutor's office, officials, tax officials and doctors. 1.2 million euros of cash and 17 tons of cocaine are confiscated — another 430 million euros in powder. During the press conference, a representative of the Belgian police directly addressed the management of SkyGlobal with a proposal to send them the number of the federal police bank account, where the prize money of $ 4 million should be transferred. In the Netherlands, 30 people are arrested on the same day, 28 "trunks" and a separate SkyECC messenger server are seized.

 The most interesting thing is the reaction of SkyGlobal: they claim that all the phones seized during the raids are cheap replicas, the messenger on them is a fake, and subscribers of their service have nothing to fear. But anyway, on March 12, 2021, a Grand jury of the US Federal Court issues an arrest warrant for the CEO of SkyGlobal. And the company's website starts to look like this:

![](https://i.imgur.com/ZuHzpsM.png)

> This is what the SkyGlobal website looks like from March 12, 2021.

There is little information about the methods of "hacking" SkyECC, but given that Europol mentions the French police in its communique and says that they managed to access messages from phones in real time, most likely the method was the same as with EncroChat — installing a Trojan on phones through the company's servers, which makes it possible get access to messages even before they are encrypted (before sending).

By the way, the reason why either the country of tulips or chocolate is constantly involved in all these stories is extremely banal — the port of Rotterdam and the port of Antwerp, respectively. Two of the largest maritime transport hubs in Europe, and therefore the most convenient places for smuggling wholesale import of "substances", from where they are already transported to retail destinations.



### AN0M

 What happened after all these events? That's right, drug dealers sighed heavily, recorded investments in these batches of goods in the “Sunk Cost” column of their financial statements and continued to work further. But it is impossible to work in intercontinental "trade" without reliable communication, therefore, another provider of encrypted communication services, the American company **AN0M**, sharply adds 6000 users within a week after the closure of SkyGlobal. And the number of subscribers continued to grow.

 AN0M devices resembled EncroChat phones: a special version of Android (ArcaneOS), microphones and GPS module were removed from the phones, of course, "panic code" and remote memory formatting, from the new one — "PIN scrambling".In general, EncroChat was the "industry standard" for a reason. The only working application on the phone was the AN0M messenger, which transmitted encrypted messages through the company's servers.

![AN0M phone lock screen, nothing unusual at first glance… But an attentive reader will notice PIN-scrambling in action.](https://habrastorage.org/r/w1560/getpro/habr/upload_files/903/5ee/b92/9035eeb920677e1167399b752c54f87c.png)

> AN0M phone lock screen, nothing unusual at first glance… But an attentive reader will notice PIN-scrambling in action.

But with the company AN0M, the gentlemen of organized criminals and drug dealers were caught — the company AN0M was created on the initiative of the FBI and the Australian police, then Europol joined the project. They outsourced only a programmer to prepare a special version of Android and a special "protected" messenger — a talented hacker from the nearest prison.

Yes, this means that all messages, photos and videos from the messenger went directly to the police servers, along with the encryption key, device identification number and approximate location (GPS was actually disabled, so triangulation by cell towers was used). Thus, over the 18 months of AN0M's operation, 27 million messages were received in several languages. For their processing, analysis and translation, the Dutch police wrote a special program code, which they shared with other participants of the operation “TrojanShield”. By the way, all this explains why the FBI unexpectedly "fit in" with the showdown between Europol and Sky Global — it was necessary to "push" organized crime to switch to AN0M.

The completion of the operation was impressive: on June 8, 2021, about 1,000 people were arrested simultaneously on the territory of 18 countries, 8 tons of cocaine, 22 tons of marijuana, 2 tons of synthetic drugs and 6 tons of precursors for them, 250 weapons, 55 cars and 48 million dollars in cash and cryptocurrency were seized. On the same day, Europol said that this operation "dealt a heavy blow to organized crime." Well, it seems to be true.

I wonder what kind of encrypted communication company the drug dealers "switched" from AN0M to? I hope we will find out this year from the police communiques.



### Conclusion

What can I add to the conclusion of my story about the struggle of a police Trojan shell with criminal crypto armor? Firstly, it's good that the shells are winning. Good must overcome evil. Secondly, do not become criminals and drug dealers. They are often put on. Thirdly, the only way to keep a secret is not to tell anyone about it. Especially through electronic means of communication.